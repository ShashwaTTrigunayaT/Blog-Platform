<!DOCTYPE html>
<html lang="en">

<head>
  <%- include("../partials/link") %>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/blog.css">
    <title>
      <%= blog.title %>
    </title>
</head>

<body>
  <%- include("../partials/nav") %>

    <!-- Blog Container -->
    <div class="blog-container">
      <div class="blog-header">
        <h1 class="blog-title">
          <%= blog.title %>
        </h1>
        <!-- Edit & Delete Buttons -->
        <% if (locals.user) { %>
          <% if (String(user._id)===String(admin)) { %>
            <div class="blog-actions">
              <a href="/blog/edit/<%= blog._id %>" class="btn-edit">Edit</a>
              <a href="/blog/delete/<%= blog._id %>" class="btn-delete"
                onclick="return confirm('Are you sure you want to delete this blog?');">
                Delete
              </a>
            </div>
            <% } %>
              <% } %>
      </div>


      <img src="<%= blog.coverImageURL %>" alt="Blog Cover" class="blog-cover">
      <p class="blog-body">
        <%= blog.body %>
      </p>
    </div>

    <!-- Author Info -->
    <div class="author-box">
      <img src="<%= blog.createdBy.profileImageURL %>" alt="Author" class="author-img">
      <span class="author-name">
        <%= blog.createdBy.fullName %>
      </span>
    </div>

    <!-- Comments -->
    <div class="comments-section">
      <h2>Comments (<%= comment.length %>)</h2>

      <% if (locals.user) { %>
        <form action="/blog/comment/<%= blog._id %>" method="post" class="comment-form">
          <input type="text" name="content" class="comment-input" placeholder="Write a comment...">
          <button type="submit" class="comment-btn">Add</button>
        </form>
        <% } %>

          <div class="comments-list">
            <% comment.forEach(comment=> { %>
              <div class="comment-card">
                <img src="<%= comment.createdBy.profileImageURL %>" alt="User" class="comment-img">
                <div>
                  <span class="comment-user">
                    <%= comment.createdBy.fullName %>
                  </span>
                  <p class="comment-text">
                    <%= comment.content %>
                  </p>
                </div>
              </div>
              <% }) %>
          </div>
    </div>

    <%- include("../partials/script") %>
</body>

</html>