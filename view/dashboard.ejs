<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard</title>
    <link rel="stylesheet" href="/css/dashboard.css">
</head>

<body>
    <!-- Include Navbar Partial -->
    <%- include("../partials/nav") %>

        <div class="dashboard-container">
            <!-- Sidebar -->
            <aside class="dashboard-sidebar">
                <div class="profile-card">
                    <form action="/blog/update-dp" method="POST" enctype="multipart/form-data" class="dp-form">
                        <label for="dp-upload" class="dp-img-label">
                            <img src="<%= user.profileImageURL %>" alt="Profile Picture"
                                class="profile-pic-lg">
                            <span class="change-text">Change Photo</span>
                        </label>
                        <input type="file" id="dp-upload" name="dp" accept="image/*" hidden>
                        <button type="submit" class="dp-save-btn">Save</button>
                    </form>
                    <h2 class="profile-name">
                        <%= user.fullName %>
                    </h2>
                    <p class="profile-email">
                        <%= user.email %>
                    </p>
                </div>

            </aside>

            <!-- Main Content -->
            <main class="dashboard-main">
                <h1 class="welcome-title">Welcome, <%= user.fullName %> ðŸ‘‹</h1>

                <!-- Stats Section -->
                <section class="stats-section">
                    <div class="stat-card">
                        <h2>
                            <%= user.blogCount || 0 %>
                        </h2>
                        <p>Blogs Written</p>
                    </div>
                    <div class="stat-card">
                        <h2>
                            <%= user.followers || 0 %>
                        </h2>
                        <p>Followers</p>
                    </div>
                    <div class="stat-card">
                        <h2>
                            <%= user.following || 0 %>
                        </h2>
                        <p>Following</p>
                    </div>
                </section>

                <!-- Recent Blogs Section -->
                <section class="recent-section">
                    <h2 class="section-title"> Recent Blogs</h2>
                    <div class="recent-blogs">
                        <% if (blog && blog.length> 0) { %>
                            <% blog.forEach(blog=> { %>
                                <div class="blog-card">
                                    <h3><a href="/blog/<%= blog._id %>">
                                            <%= blog.title %>
                                        </a></h3>

                                    <span class="blog-date">
                                        <%= blog.createdAt.toDateString() %>
                                    </span>
                                </div>
                                <% }) %>
                                    <% } else { %>
                                        <p class="no-blogs">You havenâ€™t written any blogs yet. <a
                                                href="/blog/add-new">Start now!</a></p>
                                        <% } %>
                    </div>
                </section>
            </main>
        </div>
</body>

</html>